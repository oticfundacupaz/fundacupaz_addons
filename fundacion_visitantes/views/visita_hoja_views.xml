<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="fundacion_visita_hoja_view_form" model="ir.ui.view">
        <field name="name">fundacion.visita.hoja.view.form</field>
        <field name="model">fundacion.visita.hoja</field>
        <field name="arch" type="xml">
            <form string="Hoja de Registro de Visitas">
                <header>
                    <button name="action_validate" type="object" string="Validar" class="oe_highlight"
                            invisible="state != 'draft'"/>
                    <button name="action_cancel" type="object" string="Cancelar"
                            invisible="state != 'draft'"/>
                    <button name="action_reset_draft" type="object" string="Reiniciar a Borrador"
                            invisible="state not in ['cancel']"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,done"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" icon="fa-users" type="object" name="action_view_visitas">
                            <div class="o_field_widget o_stat_info">
                                <span class="o_stat_value"><field name="visita_ids" widget="statinfo" string="Visitas" nolabel="1"/></span>
                                <span class="o_stat_text">Visitas</span>
                            </div>
                        </button>
                    </div>
                    <div class="oe_title">
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    <group>
                        <field name="date"/>
                    </group>
                    <notebook>
                        <page string="Visitas" name="visitas">
                            <field name="visita_ids" mode="list">
                                <list string="Visitas" editable="bottom" decoration-success="exit_date != False">
                                    <field name="visitor_id" domain="[('identification_number', '!=', False)]"/>
                                    <field name="identification_number" string="Cédula / ID" readonly="1"/>
                                    <field name="name" string="Nombre Completo" readonly="1"/>
                                    <field name="visit_purpose" required="1"/>
                                    <field name="destination_person"/>
                                    <field name="entry_date" widget="datetime"/>
                                    <field name="exit_date" widget="datetime"/>
                                </list>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <record id="fundacion_visita_hoja_view_list" model="ir.ui.view">
        <field name="name">fundacion.visita.hoja.view.list</field>
        <field name="model">fundacion.visita.hoja</field>
        <field name="arch" type="xml">
            <list string="Hojas de Visita">
                <field name="name" string="Referencia"/>
                <field name="date" widget="date"/>
                <field name="visita_ids" widget="statinfo" string="Visitas"/>
                <field name="state" widget="badge" decoration-success="state == 'done'" decoration-muted="state == 'cancel'" decoration-info="state == 'draft'"/>
            </list>
        </field>
    </record>

    <record id="fundacion_visita_hoja_action" model="ir.actions.act_window">
        <field name="name">Registro de Visitas</field>
        <field name="res_model">fundacion.visita.hoja</field>
        <field name="view_mode">list,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Crea una nueva hoja de registro de visitas.
            </p>
        </field>
    </record>

    <menuitem id="fundacion_menu_root" name="Fundación" sequence="10"/>
    <menuitem id="fundacion_visita_hoja_menu"
              name="Hojas de Visita"
              parent="fundacion_menu_root"
              action="fundacion_visita_hoja_action"
              sequence="10"/>

    <menuitem id="fundacion_visitantes_menu"
              name="Visitantes (historial)"
              parent="fundacion_menu_root"
              action="fundacion_visitante_action"
              sequence="20"/>

</odoo>